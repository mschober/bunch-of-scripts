#== Start Profile Functions ==#
includeRubyVersionManger(){
    [[ -s "/home/mschober/.rvm/scripts/rvm" ]] && source "/home/mschober/.rvm/scripts/rvm" # Load RVM into a shell session *as a function*
}

function _SET_PATH(){
  export PATH=$(echo "${PATH}:$(buckets | tr '\n' ':')")
}

exportPerforceEnv(){
    export P4CONFIG=$HOME/.p4config
}


createSetupPathScript() {
    SETUP_PATH=$HOME/.setupPath.sh
    rm $SETUP_PATH
    overwriteScriptWithNewExports
    clearPath
    fullPath
}

overwriteScriptWithNewExports(){
    appendToSetup '#!/bin/bash'
    appendToSetup ''
    appendToSetup 'export DEBUG_PROFILE=success!'
    globalEnvVariables
    appendRun 'export SOFTWARE_FOLDER=/home/mschober/cj/perforce/software'
    appendToSetup ''
    pathExports
}

appendToSetup(){
    echo $@ >> $SETUP_PATH
}

appendRun() {
    appendToSetup $@; $@
}

globalEnvVariables(){
    appendRun 'export APPS_HOME=$HOME/apps'
    appendRun 'export JAVA_HOME=$(/usr/libexec/java_home -v 1.8)'
    appendRun 'export LC_COLLATE=POSIX'
    appendRun 'export GOCK_HOME=$HOME/bin/checkpoints.sh'
    appendRun 'export FUNCTIONS=$HOME/functions'
    appendRun 'export JIRA=$HOME/Desktop/mschober/expedia/eww/jira/'
    #appendRun 'export NODE_HOME=$HOME/apps/usr/local/node'
    appendRun 'export PROJECT_HOME=$HOME/dev/lng/python/exp'
}

pathExports(){
    appendToSetup 'PATH=$PATH:$JAVA_HOME/bin'
    appendToSetup 'PATH=$PATH:$APPS_HOME/bin'
    appendToSetup 'PATH=$PATH:$HOME/bin'
    appendToSetup 'PATH=$PATH:$HOME/bin/filters'
    appendToSetup 'PATH=$PATH:$MAVEN_HOME/bin'
    #appendToSetup 'PATH=$PATH:$NODE_HOME/bin'
}

clearPath(){
    echo "Resetting path based on (/etc/paths)"
    PATH=$(tail -r /etc/paths | tr '\n' ':' | sed 's/:$//')
    echo $PATH
}

fullPath(){
    source $HOME/.setupPath.sh
    echo "setting path based on file: $HOME/.setupPath.sh"
    echo $PATH
    export PATH
}

#== Start Profile Changes ==#
createSetupPathScript
exportPerforceEnv
_SET_PATH
clean-bin-links
includeRubyVersionManger
